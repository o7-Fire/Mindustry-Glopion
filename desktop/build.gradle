apply plugin: 'java'

ext{
    dependsProject = [':core']
}
dependencies {
    implementation "com.github.o7-Fire.Atomic-Library:Desktop:$atomHash"
    testImplementation(rootProject)
    dependsProject.collect{ implementation(aproj(it))}
}

task base( type: Jar , dependsOn: dependsProject.collect{ it+":compileJava"}) {
    archiveFileName = "desktop.jar"
    duplicatesStrategy(DuplicatesStrategy.EXCLUDE)
    manifest {
        attributes 'Main-Class': modsNJavaMain//what
    }
    with jar
    from {
        configurations.runtimeClasspath.filter{ it.exists() }.collect { it.isDirectory() ? it : zipTree(it) }
    }
    from files(dependsProject.collect{ aproj(it).sourceSets.main.output })
}
task unVersion(type: JavaExec) {
    classpath = sourceSets.main.runtimeClasspath
    main = "org.o7.Fire.Glopion.Version"
    setWorkingDir(rootDir)
}
task sourcesJar(type: Jar, dependsOn: classes) {
    classifier = 'sources'//deprecated
    from sourceSets.main.allSource
}
artifacts {
    archives sourcesJar
    archives base
}
